tr_x2 <- train_data[, 1:3]
## for adr cluster
tr_x1 <- train_data[, 1:3]
## cluster_cr
tr_y6 <- train_data[, 5]
## cluster_ar
tr_y5 <- train_data[, 6]
## cluster_dr
tr_y4 <- train_data[, 7]
## cluster_car
tr_y3 <- train_data[, 8]
## cluster_cdr
tr_y2 <- train_data[, 9]
## cluster_adr
tr_y1 <- train_data[, 10]
## Preparing Tmap data set - 15ea, k=3
test1_data <- read.csv("Tmap_data.csv")
ts1 <- test1_data[, -4]
## Preparing Virtual data set - 182 , k=13
test2_data <- read.csv("driving_score_180ea.csv")
ts2 <- test2_data[, -4]
## Preparing new data set - 13 , k=3
test3_data <- read.csv("driving_score_new.csv")
ts3 <- test3_data[, -4]
## Classification Tmap - cluster cr
cluster6 <- knn(train = tr_x6, test = ts1, cl = tr_y6, k=3, prob=TRUE)
cluster6
## Classification Tmap - cluster ar
cluster5 <- knn(train = tr_x5, test = ts1, cl = tr_y5, k=3, prob=TRUE)
cluster5
## Classification Tmap - cluster dr
cluster4 <- knn(train = tr_x4, test = ts1, cl = tr_y4, k=3, prob=TRUE)
cluster4
## Classification Tmap - cluster car
cluster3 <- knn(train = tr_x3, test = ts1, cl = tr_y3, k=3, prob=TRUE)
cluster3
## Classification Tmap - cluster cdr
cluster2 <- knn(train = tr_x2, test = ts1, cl = tr_y2, k=3, prob=TRUE)
cluster2
## Classification Tmap - cluster adr
cluster1 <- knn(train = tr_x1, test = ts1, cl = tr_y1, k=3, prob=TRUE)
cluster1
tmap <- cbind(test1_data, cluster6, cluster5, cluster4, cluster3, cluster2, cluster1)
## Classification virtual - cluster cr
cluster6 <- knn(train = tr_x6, test = ts2, cl = tr_y6, k=13, prob=TRUE)
cluster6
## Classification virtual - cluster ar
cluster5 <- knn(train = tr_x5, test = ts2, cl = tr_y5, k=13, prob=TRUE)
cluster5
## Classification virtual - cluster dr
cluster4 <- knn(train = tr_x4, test = ts2, cl = tr_y4, k=13, prob=TRUE)
cluster4
## Classification virtual - cluster car
cluster3 <- knn(train = tr_x3, test = ts2, cl = tr_y3, k=13, prob=TRUE)
cluster3
## Classification virtual - cluster cdr
cluster2 <- knn(train = tr_x2, test = ts2, cl = tr_y2, k=13, prob=TRUE)
cluster2
## Classification virtual - cluster adr
cluster1 <- knn(train = tr_x1, test = ts2, cl = tr_y1, k=13, prob=TRUE)
cluster1
virtual <- cbind(test2_data, cluster6, cluster5, cluster4, cluster3, cluster2, cluster1)
## Classification new - cluster cr
cluster6 <- knn(train = tr_x6, test = ts3, cl = tr_y6, k=3, prob=TRUE)
cluster6
## Classification new - cluster ar
cluster5 <- knn(train = tr_x5, test = ts3, cl = tr_y5, k=3, prob=TRUE)
cluster5
## Classification new - cluster dr
cluster4 <- knn(train = tr_x4, test = ts3, cl = tr_y4, k=3, prob=TRUE)
cluster4
## Classification new - cluster car
cluster3 <- knn(train = tr_x3, test = ts3, cl = tr_y3, k=3, prob=TRUE)
cluster3
## Classification new - cluster cdr
cluster2 <- knn(train = tr_x2, test = ts3, cl = tr_y2, k=3, prob=TRUE)
cluster2
## Classification new - cluster adr
cluster1 <- knn(train = tr_x1, test = ts3, cl = tr_y1, k=3, prob=TRUE)
cluster1
new <- cbind(test3_data, cluster6, cluster5, cluster4, cluster3, cluster2, cluster1)
write.csv(tmap, "cluster_tmap.csv")
write.csv(virtual, "cluster_virtual.csv")
write.csv(new, "cluster_new.csv")
rm(list=ls())
origin <- read.csv("cluster_origin_10.csv")                      # 2000,  10
tmap <- read.csv("cluster_tmap.csv")                             # 15,    10
virtual <- read.csv("cluster_virtual.csv")                       # 182,   10
new <- read.csv("cluster_new.csv")                               # 12,    10
## regression
mod1 <- lm(result ~., data = origin)
## show model's summary
summary(mod1)
rm(list=ls())
origin <- read.csv("cluster_origin_10.csv")                      # 2000,  10
tmap <- read.csv("cluster_tmap.csv")                             # 15,    10
virtual <- read.csv("cluster_virtual.csv")                       # 182,   10
new <- read.csv("cluster_new.csv")                               # 12,    10
## regression
mod1 <- lm(result ~., data = origin)
## show model's summary
summary(mod1)
coef(mod1)[9]
coef(mod1)[8]
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1] +
prediction <- round(prediction, 1)
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1] +
prediction <- round(prediction, 1)
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1]
## setting data
answer <- tmap[, "result"]
compl <- tmap[, "compliance"]
accel <- tmap[, "acceleration"]
decel <- tmap[, "deceleration"]
clust6 <- tmap[, "cluster_cr"]
clust5 <- tmap[, "cluster_ar"]
clust4 <- tmap[, "cluster_dr"]
clust3 <- tmap[, "cluster_car"]
clust2 <- tmap[, "cluster_cdr"]
clust1 <- tmap[, "cluster_adr"]
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1]
prediction <- round(prediction, 1)
## compare with real answer
compare <- cbind(prediction, answer, abs(prediction-answer))
#compare <- cbind(compl, accel, decel, clust3, clust2, clust1, clust0, compare)
compare <- cbind(compl, accel, decel, clust6, clust5, clust4, clust3, clust2, clust1, compare)
rm(list=ls())
origin <- read.csv("cluster_origin_10.csv")                      # 2000,  10
tmap <- read.csv("cluster_tmap.csv")                             # 15,    10
virtual <- read.csv("cluster_virtual.csv")                       # 182,   10
new <- read.csv("cluster_new.csv")                               # 12,    10
## regression
mod1 <- lm(result ~., data = origin)
## show model's summary
summary(mod1)
## setting data
answer <- tmap[, "result"]
compl <- tmap[, "compliance"]
accel <- tmap[, "acceleration"]
decel <- tmap[, "deceleration"]
clust6 <- tmap[, "cluster_cr"]
clust5 <- tmap[, "cluster_ar"]
clust4 <- tmap[, "cluster_dr"]
clust3 <- tmap[, "cluster_car"]
clust2 <- tmap[, "cluster_cdr"]
clust1 <- tmap[, "cluster_adr"]
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1]
prediction <- round(prediction, 1)
## compare with real answer
compare <- cbind(prediction, answer, abs(prediction-answer))
#compare <- cbind(compl, accel, decel, clust3, clust2, clust1, clust0, compare)
compare <- cbind(compl, accel, decel, clust6, clust5, clust4, clust2, clust1, compare)
#colnames(compare) <- c("compl", "accel", "decel", "clust3", "clust_cd", "clust_ca", "clust_ad", "pred", "answer", "loss")
colnames(compare) <- c("compl", "accel", "decel", "clust_cr", "clust_ar", "clust_dr", "clust_cdr", "clust_adr", "pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum((prediction-answer)^2)/nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## DSI
rm(list=ls())
origin <- read.csv("cluster_origin_10.csv")                      # 2000,  10
tmap <- read.csv("cluster_tmap.csv")                             # 15,    10
virtual <- read.csv("cluster_virtual.csv")                       # 182,   10
new <- read.csv("cluster_new.csv")                               # 12,    10
## regression
mod1 <- lm(result ~., data = origin)
## show model's summary
summary(mod1)
## setting data
answer <- new[, "result"]
compl <- new[, "compliance"]
accel <- new[, "acceleration"]
decel <- new[, "deceleration"]
clust6 <- new[, "cluster_cr"]
clust5 <- new[, "cluster_ar"]
clust4 <- new[, "cluster_dr"]
clust3 <- new[, "cluster_car"]
clust2 <- new[, "cluster_cdr"]
clust1 <- new[, "cluster_adr"]
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1]
prediction <- round(prediction, 1)
## compare with real answer
compare <- cbind(prediction, answer, abs(prediction-answer))
#compare <- cbind(compl, accel, decel, clust3, clust2, clust1, clust0, compare)
compare <- cbind(compl, accel, decel, clust6, clust5, clust4, clust2, clust1, compare)
#colnames(compare) <- c("compl", "accel", "decel", "clust3", "clust_cd", "clust_ca", "clust_ad", "pred", "answer", "loss")
colnames(compare) <- c("compl", "accel", "decel", "clust_cr", "clust_ar", "clust_dr", "clust_cdr", "clust_adr", "pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum((prediction-answer)^2)/nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## DSI
rm(list=ls())
origin <- read.csv("cluster_origin_10.csv")                      # 2000,  10
tmap <- read.csv("cluster_tmap.csv")                             # 15,    10
virtual <- read.csv("cluster_virtual.csv")                       # 182,   10
new <- read.csv("cluster_new.csv")                               # 12,    10
## regression
mod1 <- lm(result ~., data = origin)
## show model's summary
summary(mod1)
## setting data
answer <- virtual[, "result"]
compl <- virtual[, "compliance"]
accel <- virtual[, "acceleration"]
decel <- virtual[, "deceleration"]
clust6 <- virtual[, "cluster_cr"]
clust5 <- virtual[, "cluster_ar"]
clust4 <- virtual[, "cluster_dr"]
clust3 <- virtual[, "cluster_car"]
clust2 <- virtual[, "cluster_cdr"]
clust1 <- virtual[, "cluster_adr"]
## create model
#prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] + clust3 * coef(mod1)[5] +
# clust2 * coef(mod1)[5] + clust1 * coef(mod1)[6] + clust0 * coef(mod1)[7] + coef(mod1)[1]
prediction <- compl * coef(mod1)[2] + accel * coef(mod1)[3] + decel * coef(mod1)[4] +
clust6 * coef(mod1)[5] + clust5 * coef(mod1)[6] + clust4 * coef(mod1)[7] +
clust2 * coef(mod1)[9] + clust1 * coef(mod1)[10] + coef(mod1)[1]
prediction <- round(prediction, 1)
## compare with real answer
compare <- cbind(prediction, answer, abs(prediction-answer))
#compare <- cbind(compl, accel, decel, clust3, clust2, clust1, clust0, compare)
compare <- cbind(compl, accel, decel, clust6, clust5, clust4, clust2, clust1, compare)
#colnames(compare) <- c("compl", "accel", "decel", "clust3", "clust_cd", "clust_ca", "clust_ad", "pred", "answer", "loss")
colnames(compare) <- c("compl", "accel", "decel", "clust_cr", "clust_ar", "clust_dr", "clust_cdr", "clust_adr", "pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum((prediction-answer)^2)/nrow(compare) )
RMSE
## show model's summary
summary(mod1)
coef(mod1)[1]
coef(mod1)[2]
coef(mod1)[3]
coef(mod1)[4]
coef(mod1)[5]
coef(mod1)[6]
coef(mod1)[7]
coef(mod1)[8]
coef(mod1)[9]
coef(mod1)[10]
rm(list=ls())
library(randomForest)
origin <- read.csv("cluster_origin_10.csv")                      # 2000, 7
tmap <- read.csv("cluster_tmap.csv")                             # 15,   7
virtual <- read.csv("cluster_virtual.csv")                       # 182,  7
new <- read.csv("cluster_new.csv")                               # 12,   7
ds.train <- origin[,]
ds.test <- new[,]
ds.train <- origin[,]
ds.test <- virtual[,]
d_score.rf <- randomForest(result ~ ., data=ds.train, ntree = 5000)
d_score.rf
d_score.pred <- predict(d_score.rf, ds.test)
d_score.pred <- round(d_score.pred, 1)
## compare with real answer
compare <- cbind(d_score.pred, ds.test[, "result"], abs(d_score.pred-ds.test[,"result"]))
compare <- cbind(ds.test[,-4], compare)
colnames(compare) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum( ( d_score.pred-ds.test[, "result"] )^2 )  / nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## RF
rm(list=ls())
library(randomForest)
origin <- read.csv("cluster_origin_10.csv")                      # 2000, 7
tmap <- read.csv("cluster_tmap.csv")                             # 15,   7
virtual <- read.csv("cluster_virtual.csv")                       # 182,  7
new <- read.csv("cluster_new.csv")                               # 12,   7
ds.train <- origin[,]
ds.test <- tmap[,]
d_score.rf <- randomForest(result ~ ., data=ds.train, ntree = 5000)
d_score.rf
d_score.pred <- predict(d_score.rf, ds.test)
d_score.pred <- round(d_score.pred, 1)
## compare with real answer
compare <- cbind(d_score.pred, ds.test[, "result"], abs(d_score.pred-ds.test[,"result"]))
compare <- cbind(ds.test[,-4], compare)
colnames(compare) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum( ( d_score.pred-ds.test[, "result"] )^2 )  / nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## RF
rm(list=ls())
library(randomForest)
origin <- read.csv("cluster_origin_10.csv")                      # 2000, 7
tmap <- read.csv("cluster_tmap.csv")                             # 15,   7
virtual <- read.csv("cluster_virtual.csv")                       # 182,  7
new <- read.csv("cluster_new.csv")                               # 12,   7
ds.train <- origin[,]
ds.test <- new[,]
d_score.rf <- randomForest(result ~ ., data=ds.train, ntree = 5000)
d_score.rf
d_score.pred <- predict(d_score.rf, ds.test)
d_score.pred <- round(d_score.pred, 1)
## compare with real answer
compare <- cbind(d_score.pred, ds.test[, "result"], abs(d_score.pred-ds.test[,"result"]))
compare <- cbind(ds.test[,-4], compare)
colnames(compare) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum( ( d_score.pred-ds.test[, "result"] )^2 )  / nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## SVM
rm(list=ls())
library(e1071)
origin <- read.csv("cluster_origin_10.csv")                      # 182,  8
tmap <- read.csv("cluster_tmap.csv")                             # 15,   8
virtual <- read.csv("cluster_virtual.csv")                       # 1248, 8
new <- read.csv("cluster_new.csv")                               # 12,   8
x_train <- origin[, -4]
y_train <- origin[, 4]
x_test <- new[, -4]
y_test <- new[, 4]
# training with train data
#model <- svm(x_train, y_train, type = "nu-regression")
model <- svm(x_train, y_train)
summary(model)
# test with test data
pred <- predict(model, x_test)
pred <- round(pred, 1)
## compare with real answer
compare <- cbind(x_test[,], pred, y_test, abs(pred-y_test))
colnames(compare) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum( ( pred-y_test )^2 )  / nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## SVM
rm(list=ls())
library(e1071)
origin <- read.csv("cluster_origin_10.csv")                      # 182,  8
tmap <- read.csv("cluster_tmap.csv")                             # 15,   8
virtual <- read.csv("cluster_virtual.csv")                       # 1248, 8
new <- read.csv("cluster_new.csv")                               # 12,   8
x_train <- origin[, -4]
y_train <- origin[, 4]
x_test <- tmap[, -4]
y_test <- tmap[, 4]
# training with train data
#model <- svm(x_train, y_train, type = "nu-regression")
model <- svm(x_train, y_train)
summary(model)
# test with test data
pred <- predict(model, x_test)
pred <- round(pred, 1)
## compare with real answer
compare <- cbind(x_test[,], pred, y_test, abs(pred-y_test))
colnames(compare) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum( ( pred-y_test )^2 )  / nrow(compare) )
RMSE
## model = origin // data = tmap & virtual // goal = data's result prediction
## SVM
rm(list=ls())
library(e1071)
origin <- read.csv("cluster_origin_10.csv")                      # 182,  8
tmap <- read.csv("cluster_tmap.csv")                             # 15,   8
virtual <- read.csv("cluster_virtual.csv")                       # 1248, 8
new <- read.csv("cluster_new.csv")                               # 12,   8
x_train <- origin[, -4]
y_train <- origin[, 4]
x_test <- virtual[, -4]
y_test <- virtual[, 4]
# training with train data
#model <- svm(x_train, y_train, type = "nu-regression")
model <- svm(x_train, y_train)
summary(model)
# test with test data
pred <- predict(model, x_test)
pred <- round(pred, 1)
## compare with real answer
compare <- cbind(x_test[,], pred, y_test, abs(pred-y_test))
colnames(compare) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
compare
## calculate RMSE
RMSE <- sqrt( sum( ( pred-y_test )^2 )  / nrow(compare) )
RMSE
rm(list=ls())
library(keras)
library(MASS)
use_session_with_seed(1, disable_parallel_cpu = FALSE)
## read csv file for model
m_score <- read.csv("cluster_origin_10.csv")
## read csv file for data
d_score <- read.csv("cluster_virtual.csv")
x_train <- as.matrix(m_score[, -4])
y_train <- as.matrix(m_score[, 4])
x_test <- as.matrix(d_score[, -4])
y_test <- as.matrix(d_score[, 4])
# create model
model = keras_model_sequential()
model %>%
layer_dense(input_shape = ncol(x_train), units = 128, activation = "relu") %>%
layer_dropout(rate = 0.05) %>%
layer_dense(units = 128, activation = "relu") %>%
layer_dropout(rate = 0.05) %>%
layer_dense(units = 64, activation = "relu") %>%
layer_dropout(rate = 0.05) %>%
layer_dense(units = 32, activation = "relu") %>%
layer_dropout(rate = 0.05) %>%
layer_dense(units = 16, activation = "relu") %>%
layer_dense(units = 1)
summary(model)
# create model
model = keras_model_sequential()
model %>%
layer_dense(input_shape = ncol(x_train), units = 128, activation = "relu") %>%
layer_dropout(rate = 0.1) %>%
layer_dense(units = 128, activation = "relu") %>%
layer_dropout(rate = 0.1) %>%
layer_dense(units = 64, activation = "relu") %>%
layer_dropout(rate = 0.1) %>%
layer_dense(units = 32, activation = "relu") %>%
layer_dropout(rate = 0.1) %>%
layer_dense(units = 16, activation = "relu") %>%
layer_dense(units = 1)
summary(model)
# add a loss function and optimizer
model %>%
compile(
loss = "logcosh",
optimizer = "Nadam",
metrics = list("mean_absolute_error")
)
fit = model %>%
fit(
x = x_train,
y = y_train,
batch_size = 256,
epochs = 3000
)
# Training and evaluation
model %>% evaluate(x_test, y_test, verbose = 1)
# print predicted value
pred = model %>% predict(x_test)
result <- cbind(x_test[,], pred, y_test, pred-y_test)
colnames(result) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","pred", "answer", "loss")
colnames(result) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
result
## calculate RMSE
RMSE <- sqrt( sum( ( pred-y_test )^2 )  / nrow(result) )
RMSE
## read csv file for data
d_score <- read.csv("cluster_new.csv")
x_test <- as.matrix(d_score[, -4])
y_test <- as.matrix(d_score[, 4])
# Training and evaluation
model %>% evaluate(x_test, y_test, verbose = 1)
# print predicted value
pred = model %>% predict(x_test)
result <- cbind(x_test[,], pred, y_test, pred-y_test)
colnames(result) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
result
## calculate RMSE
RMSE <- sqrt( sum( ( pred-y_test )^2 )  / nrow(result) )
RMSE
## read csv file for data
d_score <- read.csv("cluster_tmap.csv")
x_train <- as.matrix(m_score[, -4])
y_train <- as.matrix(m_score[, 4])
x_test <- as.matrix(d_score[, -4])
y_test <- as.matrix(d_score[, 4])
# Training and evaluation
model %>% evaluate(x_test, y_test, verbose = 1)
# print predicted value
pred = model %>% predict(x_test)
result <- cbind(x_test[,], pred, y_test, pred-y_test)
colnames(result) <- c("compl","accel","decel","clust_cr","clust_ar","clust_dr","clust_car","clust_cdr","clust_adr","pred", "answer", "loss")
result
## calculate RMSE
RMSE <- sqrt( sum( ( pred-y_test )^2 )  / nrow(result) )
RMSE
